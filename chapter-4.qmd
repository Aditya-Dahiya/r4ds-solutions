---
title: "Data transformation"
---

## Prerequisites

```{r}
library(nycflights13)
library(tidyverse)
#> ── Attaching packages ──────────────────────────────────── tidyverse 1.3.2 ──
#> ✔ ggplot2 3.4.0           ✔ purrr   1.0.1.9000 
#> ✔ tibble  3.1.8           ✔ dplyr   1.0.99.9000
#> ✔ tidyr   1.2.1.9001      ✔ stringr 1.5.0      
#> ✔ readr   2.1.3           ✔ forcats 0.5.2      
#> ── Conflicts ─────────────────────────────────────── tidyverse_conflicts() ──
#> ✖ dplyr::filter() masks stats::filter()
#> ✖ dplyr::lag()    masks stats::lag()
```

##Solutions

## 4.2.5 Exercises

1.  

```{=html}
<!-- -->
```
a.  

```{r}
filter(flights,arr_delay >= 2) |> 
  arrange(desc(arr_delay))
```

b.  Flew to houston (IAH or HOU)

```{r}
flights |>
  filter(dest %in% c("IAH","HOU"))
```

c.  

```{r}
flights |>
  filter(carrier %in% c("UA","DL","AA"))
```

d.  

```{r}
flights |>
  filter(month %in% c(7,8,9))
```

e.  

```{r}
flights |> 
  filter(dep_delay >= 0,arr_delay < -2)
```

f.  

```{r}
flights |> 
  filter(dep_delay <= -1,arr_delay > 30)
```

2.  

```{r}
flights |> 
  arrange(dep_delay) |> 
  arrange(time_hour)
```

3.  

```{r}
flights |> 
  arrange(desc(arr_delay))
```

4.Yes

```{r}
flights |> 
  arrange(desc(day)) |> 
  arrange(desc(month))
```

5.  

```{r}
flights |> 
  arrange(distance) 
```

```{r}
flights |> 
  arrange(desc(distance))
```

6.  I don't think it matters the two functions would go over each other with no problems either way.

## 4.3.5 Exercises

1.  No they don't match.

    ```{r}
    flights |> 
      mutate(timearrdep = arr_time - dep_time)
    ```

2.  They show when a plane left when it was supposed to leave and if there was a delay.

3.  

```{r}
flights |> 
  select(dep_time, dep_delay, arr_time, arr_delay)
```

```{r}
select(flights, dep_time:arr_delay, -sched_dep_time,-sched_arr_time)
```

4.  Nothing happens, you just get the variable once.

```{r}
flights |> 
  select(dep_time, dep_time)
```

5.  You ask if `any_of()` these variables have a certain thing you are looking for.

```{r}
variables <- c("year", "month", "day", "dep_delay", "arr_delay")
```

6.  No it doesn't surprise me.it looks like case doesn't matter.i can change time to dep.

```{r}
select(flights, contains("TIME"))
```

## 4.4.6 Exercises

1.  It looks like 9E has the worst delays.

```{r}
flights |> 
  group_by(carrier, dep_delay) |> 
  summarize(n())

flights |> 
  arrange(desc(dep_delay))
```

2.  

```{r}
flights |> 
  group_by(dep_delay,dest) |> 
  summarise(n())
```

3.  

```{r}
#| eval: false
ggplot(flights,aes(x = time_hour,y = dep_delay)) + 
  geom_smooth()
```

4.You get a error.

```{r}
#| error: true
flights |> 
  slice_min(-n)
```

5.Count,counts the number of things in each specific group,will show the largest group at the top.

6.  

```{r}
df <- tibble(
  x = 1:5,
  y = c("a", "b", "a", "a", "b"),
  z = c("K", "K", "L", "L", "K")
)
```

a.It would group by y.

```{r}
df |>
  group_by(y)
```

b.What arrange did here is arranged y in alphabetical order in this case.

```{r}
df |>
  arrange(y)
```

c.  The pipeline tells the code what to do next, it groups by y then finds the average of x.

```{r}
df |>
  group_by(y) |>
  summarize(mean_x = mean(x))
```

d.  The code groups by y and z then averages x,then it shows theres a average of 1 k for a y,an average of 3.5 L's for the second a in y and an average of 3.5 k's for b.

```{r}
df |>
  group_by(y, z) |>
  summarize(mean_x = mean(x))
```

e.  This code completely gets rid of the group by part the function that does this is .groups = "drop".

```{r}
df |>
  group_by(y, z) |>
  summarize(mean_x = mean(x), .groups = "drop")
```

f.  These codes do the same thing the only difference is that the first code shows the information in a more efficient way due to summarize.

```{r}
df |>
  group_by(y, z) |>
  summarize(mean_x = mean(x))

df |>
  group_by(y, z) |>
  mutate(mean_x = mean(x))
```
